# å†å²ä¸Šçš„ä»Šå¤© Home Assistant é›†æˆ

è¿™æ˜¯ä¸€ä¸ªç”¨äº Home Assistant çš„é›†æˆï¼Œé€šè¿‡æ¢æ•°APIè·å–"å†å²ä¸Šçš„ä»Šå¤©"æ•°æ®ï¼Œå¹¶æä¾›æ»šåŠ¨æ˜¾ç¤ºåŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ“… è·å–å†å²ä¸Šçš„ä»Šå¤©é‡è¦äº‹ä»¶
- ğŸ”„ è‡ªåŠ¨è¿‡æ»¤æ•æ„Ÿå†…å®¹ï¼ˆé€ä¸–ã€å»ä¸–ç­‰ï¼‰
- â° å¯é…ç½®çš„æ•°æ®æ›´æ–°é—´éš”ï¼ˆ60-43200åˆ†é’Ÿï¼‰
- ğŸ“œ å¤´æ¡æ»šåŠ¨æ˜¾ç¤ºåŠŸèƒ½ï¼Œå¯é…ç½®æ»šåŠ¨é—´éš”ï¼ˆ5-300ç§’ï¼‰
- ğŸ·ï¸ ä¸­æ–‡ç•Œé¢ï¼Œæ˜“äºé…ç½®
- ğŸ“Š æä¾›ä¸¤ä¸ªå®ä½“ï¼šä»Šæ—¥å†å²å’Œæ»šåŠ¨å†å²

## å®‰è£…

### é€šè¿‡ HACS å®‰è£…ï¼ˆæ¨èï¼‰

1. åœ¨ HACS ä¸­ç‚¹å‡»"é›†æˆ"
2. ç‚¹å‡»å³ä¸‹è§’çš„"æ·»åŠ è‡ªå®šä¹‰å­˜å‚¨åº“"
3. è¾“å…¥ä»“åº“URL (https://github.com/lambilly/hass_today_history/)
4. å¹¶é€‰æ‹©ç±»åˆ«ä¸º"é›†æˆ"
5. åœ¨é›†æˆåˆ—è¡¨ä¸­æ‰¾åˆ°"å†å²ä¸Šçš„ä»Šå¤©"å¹¶å®‰è£…
6. é‡å¯ Home Assistant

### æ‰‹åŠ¨å®‰è£…

1. å°† `custom_components/today_history` æ–‡ä»¶å¤¹å¤åˆ¶åˆ°æ‚¨çš„ Home Assistant é…ç½®ç›®å½•ä¸­
2. é‡å¯ Home Assistant

## é…ç½®

### ç¬¬ä¸€æ­¥ï¼šè·å– API å¯†é’¥

1. è®¿é—® [æ¢æ•°API](https://www.tanshuapi.com/)
2. æ³¨å†Œè´¦å·å¹¶ç”³è¯·å…è´¹çš„"å†å²ä¸Šçš„ä»Šå¤©"APIå¯†é’¥

### ç¬¬äºŒæ­¥ï¼šæ·»åŠ é›†æˆ

1. è¿›å…¥ Home Assistant â†’ è®¾ç½® â†’ è®¾å¤‡ä¸æœåŠ¡ â†’ é›†æˆ
2. ç‚¹å‡»"æ·»åŠ é›†æˆ"
3. æœç´¢"å†å²ä¸Šçš„ä»Šå¤©"
4. è¾“å…¥æ‚¨çš„ API å¯†é’¥
5. é…ç½®æ•°æ®æ›´æ–°é—´éš”å’Œå¤´æ¡æ»šåŠ¨é—´éš”
6. ç‚¹å‡»æäº¤

## å®ä½“

é›†æˆä¼šåˆ›å»ºä»¥ä¸‹å®ä½“ï¼š

### ä¼ æ„Ÿå™¨.ä»Šæ—¥å†å²
- **çŠ¶æ€**: æ•°æ®æ›´æ–°æ—¶é—´
- **å±æ€§**:
  - `title`: æ ‡é¢˜
  - `today_item`: ä»Šæ—¥å†å²äº‹ä»¶
  - `history_list`: å†å²äº‹ä»¶åˆ—è¡¨
  - `total_count`: æ€»äº‹ä»¶æ•°é‡
  - `update_interval`: æ•°æ®æ›´æ–°é—´éš”ï¼ˆåˆ†é’Ÿï¼‰

### ä¼ æ„Ÿå™¨.æ»šåŠ¨å†å²
- **çŠ¶æ€**: å½“å‰æ—¥æœŸ
- **å±æ€§**:
  - `title`: äº‹ä»¶æ ‡é¢˜
  - `year`: äº‹ä»¶å¹´ä»½
  - `month`: äº‹ä»¶æœˆä»½
  - `day`: äº‹ä»¶æ—¥æœŸ
  - `content`: äº‹ä»¶å†…å®¹
  - `scroll_index`: å½“å‰æ»šåŠ¨ç´¢å¼•
  - `total_items`: æ€»äº‹ä»¶æ•°é‡
  - `scroll_interval`: æ»šåŠ¨é—´éš”ï¼ˆç§’ï¼‰

## è®¾å¤‡

é›†æˆä¼šåˆ›å»ºä¸€ä¸ªåä¸º"ä¿¡æ¯æŸ¥è¯¢"çš„è®¾å¤‡ï¼ŒåŒ…å«ä¸Šè¿°ä¸¤ä¸ªå®ä½“ã€‚

## é…ç½®é€‰é¡¹

åœ¨é›†æˆé€‰é¡¹ä¸­å¯ä»¥è°ƒæ•´ä»¥ä¸‹è®¾ç½®ï¼š

- **æ•°æ®æ›´æ–°é—´éš”**: 60-43200åˆ†é’Ÿï¼ˆé»˜è®¤1440åˆ†é’Ÿï¼Œå³24å°æ—¶ï¼‰
- **å¤´æ¡æ»šåŠ¨é—´éš”**: 5-300ç§’ï¼ˆé»˜è®¤30ç§’ï¼‰

## å¡ç‰‡æ˜¾ç¤ºï¼Œéœ€è¦åœ¨HACSå®‰è£…ï¼šLovelace HTML Jinja2 Template card å¡ç‰‡

```yaml
type: custom:html-template-card
content: >-
  {% set content = state_attr('sensor.xin_xi_cha_xun_gun_dong_li_shi',
  'content') %} {% set month =
  state_attr('sensor.xin_xi_cha_xun_gun_dong_li_shi', 'month') %} {% set day =
  state_attr('sensor.xin_xi_cha_xun_gun_dong_li_shi', 'day') %}<div 
  style="color: white;"><p align=left><h3 style="color: white; margin-bottom:
  0px;">ã€ğŸ“‹å†å²ä¸Šçš„ä»Šå¤©ã€‘({{month}}æœˆ{{day}}æ—¥)</h3> </p> </div> <p align= left
  style="color:  white; font-size: 1.0em; margin-top: 10px;">{{ content }}</p>
```
## æ•…éšœæ’é™¤
### å¸¸è§é—®é¢˜
1.	APIå¯†é’¥æ— æ•ˆ
o	æ£€æŸ¥APIå¯†é’¥æ˜¯å¦æ­£ç¡®
o	ç¡®è®¤åœ¨æ¢æ•°APIå¹³å°å·²æ¿€æ´»"å†å²ä¸Šçš„ä»Šå¤©"æœåŠ¡
2.	æ— æ³•è·å–æ•°æ®
o	æ£€æŸ¥ç½‘ç»œè¿æ¥
o	æŸ¥çœ‹Home Assistantæ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
3.	å®ä½“ä¸æ›´æ–°
o	æ£€æŸ¥æ•°æ®æ›´æ–°é—´éš”è®¾ç½®
o	ç¡®è®¤é›†æˆé…ç½®æ­£ç¡®

## æ—¥å¿—è°ƒè¯•
å¦‚éœ€è°ƒè¯•ä¿¡æ¯ï¼Œè¯·åœ¨ configuration.yaml ä¸­æ·»åŠ ï¼š

```yaml
logger:
  default: info
  logs:
    custom_components.today_history: debug
```
## æ”¯æŒ
å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š
1.	æŸ¥çœ‹ Home Assistant æ—¥å¿—
2.	æ£€æŸ¥é›†æˆé…ç½®
3.	åœ¨é¡¹ç›®ä»“åº“æäº¤ Issue

## è®¸å¯è¯
MIT License

## è´¡çŒ®
æ¬¢è¿æäº¤ Pull Request å’Œ Issue æ¥æ”¹è¿›è¿™ä¸ªé›†æˆã€‚

## æèµ æ”¯æŒ

å¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªé›†æˆå¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œæ¬¢è¿æ‰«æä¸‹æ–¹çš„äºŒç»´ç è¿›è¡Œæèµ ï¼Œä»¥æ”¯æŒé¡¹ç›®çš„æŒç»­å¼€å‘å’Œç»´æŠ¤ï¼š

|    |æ”¯ä»˜å® | å¾®ä¿¡ |
|----|--------|------|
|æ‰«ä¸€æ‰«|![Image](https://github.com/user-attachments/assets/a6d0872c-d14b-4534-ba35-c8e9daeb2849)|![Image](https://github.com/user-attachments/assets/a0bcbb66-978e-4f51-9caf-1c3375155867)|
